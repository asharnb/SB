
<div class="row">
  <div class="col-sm-12 col-md-8">
    <h3 class="no-margins p-b-sm">Photography Sessions</span></h3>
    <h4 class="no-margins">View and track all your sessions or add a new session</h4>
  </div>
  <div class="col-sm-12 col-md-4 m-t-md">
    <a class="btn btn-primary btn-cons pull-right" href="/sbtest/node/add/sessions">Add New Session</a>
  </div>
</div>
<hr class="simple">

<div class="panel panel-default">
  <div class="">
    <div class="panel-body" style="padding-left:0px !important;">
        <div id="dt_viewsessions_filter" class="col-sm-5 search-container">
              <div class="input-group">
        <span class="input-group-addon" id="basic-addon1"><i class="fa fa-search"></i></span>
        <input type="text" class="form-control input-sm" placeholder="What are you looking for?" id="dt_search_box">


      </div>
        </div>
        <div class="col-sm-4">
      <button type="button" id="btn_search_reset" class="btn">Reset</button>
        </div>

    </div>
  </div>
</div>
<div class="panel panel-default">
  <!-- NEW COL START -->
  <article class="m-sm">
    <table id="dt_viewsessions" class="table table-responsive  table-striped table-hover" width="100%">

      <thead>
        <th>ID</th>
        <th>Status</th>
        <th>Concept(s)</th>
        <th>Contributors</th>
        <th>Date Created</th>
        <th>Total Products</th>
        <th></th>
      </thead>

      <tbody>


        {% for result in results %}

        {% set total_count = result.mapped.0.mappedcount + result.unmapped.0.unmappedcount %}

        {#rules for status stages#}
            {% if result.stage.0.value == 'open' and total_count == 0  %}
              {% set status_class = '<span class="text-success"><i class=""></i> Started</span>' %}
            {% elseif result.stage.0.value == 'open' and total_count > 0   %}
              {% set status_class = '<span class="text-success"><i class=""></i> Importing Products</span>' %}
            {% endif %}

            {% if result.stage.0.value == 'pause' and total_count == 0  %}
              {% set status_class = '<span class="text-warning"><i class=""></i> Paused</span>' %}
            {% endif %}

            {% if result.stage.0.value == 'closed' and total_count == 0  %}
              {% set status_class = '<span class="text-danger"><i class=""></i> Cancelled</span>' %}
            {% elseif result.stage.0.value == 'closed' and result.unmapped.0.unmappedcount > 0   %}
              {% set status_class = '<span class="text-danger"><i class=""></i>'~ result.unmapped.0.unmappedcount ~' items unmapped</span>' %}
            {% elseif result.stage.0.value == 'closed' and result.unmapped.0.unmappedcount == 0  and total_count > 0 %}
                {% set status_class = '<span class="text-warning"><i class=""></i> Shootlist Pending</span>' %}
            {% endif %}

        {#rules for status stages#}
            {% if result.shootdate.0.value|date('Y-m-d') == "now"|date("Y-m-d") %}
              {% set date_class = 'text-success' %}
              {% set date_text = 'Today, ' ~ result.shootdate.0.value|date("h:m a") %}
            {% elseif result.shootdate.0.value|date('Y-m-d') == "now"|date_modify("-1 day")|date("Y-m-d") %}
              {% set date_class = '' %}
              {% set date_text = 'Yesterday, ' ~ result.shootdate.0.value|date("h:m a") %}
            {% else %}
              {% set date_class = '' %}
              {% set date_text = result.shootdate.0.value|date("M d, Y, h:m a") %}
            {% endif %}




        <tr>

          <td>{{ result.id }}</td>
          <td>{{ status_class|raw }}</td>
          <td>
            {% if result.concepts|length == 0 %}
                Not Available

            {% elseif result.concepts|length > 1 %}

                <img src="/sbtest/{{directory}}/images/brands/brand_logo_{{result.concepts.0.concept|lower}}.png" height="20px"> <span class="text text-complete bold">   +{{result.concepts|length -1}}</span>

            {% endif %}
          </td>
          <td>
            <img src="/sbtest/{{directory}}/images/users/{{ random(['niranjan', 'vikas', 'anahita', 'moosa', 'azhar']) }}.jpg" class="img-circle-table " alt="niranjan">
            <img src="/sbtest/{{directory}}/images/users/{{ random(['disha', 'rebecca']) }}.jpg" class="img-circle-table " alt="ashar">
            <img src="/sbtest/{{directory}}/images/users/{{ random(['althea', 'rinki']) }}.jpg" class="img-circle-table " alt="aqeel">
          </td>
          <td><span class="{{date_class}}">{{ date_text }}</span></td>

          <td class="bold">{{total_count}}</td>
          <td>
            <a class="btn btn-xs " href="/sbtest/view-session/{{ result.id }}">View</a>
          </td>

        </tr>

        {% endfor %}


      </tbody>
    </table>

  </article>
  <!-- END COL -->
</div>
